<template>
  <div class="sign-up">
    <PriorityMessages></PriorityMessages>    
    <PrimaryNav></PrimaryNav>    
    <VulnerabilityNav></VulnerabilityNav>
    <div class="su-inner">
    	<div class="su-steps">
    		<div class="su-step su-step-1" v-if="isOnFirstStep()">
    			<div class="su-roles">
    				<router-link to="/signup?role=discoverer" tag="div" class="su-role su-role-discoverer">
    					<div class="su-role-icon">
								<svg width="92" height="92">
									<g>
										<polygon class="svg-fg" points="38.4,38.2 38.4,38.2 38.4,38.2 	"/>
										<polygon class="svg-fg" points="38.4,38.2 38.4,38.2 38.4,38.2 	"/>
										<path d="M53.8,52.4H22.9l-4.6-7.9l15.4-26.7l9.2,0l15.4,26.7L53.8,52.4z M24.7,49.4h27.4l2.8-4.9L41.2,20.8l-5.7,0L21.8,44.5
											L24.7,49.4z"/>
									</g>
									<rect x="36.5" y="27" width="3.7" height="11.2"/>
									<rect x="36.5" y="41.5" width="3.7" height="3.6"/>
									<path d="M89.3,85.7l-24-24c12.2-14,11.6-35.3-1.7-48.7C49.7-0.8,27-0.8,13.1,13.1c-13.9,13.9-13.9,36.6,0,50.5
										c7,7,16.1,10.4,25.2,10.4c8.4,0,16.7-2.9,23.4-8.7l24,24c0.5,0.5,1.1,0.7,1.8,0.7s1.3-0.2,1.8-0.7C90.2,88.3,90.2,86.7,89.3,85.7z
										 M16.6,60.1c-5.8-5.8-9-13.5-9-21.7c0-8.2,3.2-15.9,9-21.7c5.8-5.8,13.5-9,21.7-9c8.2,0,15.9,3.2,21.7,9c5.8,5.8,9,13.5,9,21.7
										c0,8.2-3.2,15.9-9,21.7s-13.5,9-21.7,9C30.2,69.1,22.4,65.9,16.6,60.1z"/>
								</svg>    						
    					</div>
    					<div class="su-role-text">
    						<div class="su-role-title">Discoverer</div>
    						<div class="su-role-description">
    							Discoverers are individuals who find software vulnerabilities and provide vulnerability information by identifying new vulnerabilities and updating existing vulnerabilities in the CVE system
    						</div>
    					</div><!-- .su-role-text -->
    				</router-link>
    				<router-link to="/signup?role=authority" tag="div" class="su-role su-role-authority">
    					<div class="su-role-icon">
								<svg width="92" height="92">
									<g>
										<polygon points="59,37.5 56.3,34.8 42.8,48.2 38,43.4 35.3,46.2 42.8,53.7 42.8,53.7 42.8,53.7 	"/>
										<path d="M47.3,86.9h-2.6L32,78.2C27.5,75,13.7,65.3,13.7,54.2V15.8L45.5,4h0.9l0.5,0.2l31.4,11.7v38.4c0,11.1-13.7,20.9-18.2,24
											L47.3,86.9z M18.7,19.3v34.9c0,3.9,2.8,10.5,16.1,20L46,81.7l11.2-7.6c13.3-9.4,16.1-16,16.1-19.9V19.3L46,9.1L18.7,19.3z"/>
									</g>
								</svg>
    					</div>
    					<div class="su-role-text">
    						<div class="su-role-title">Authority</div>
    						<div class="su-role-description">
    							Authorities are vendors and organizations that own software products and platforms that are authorized to officially confirm and assign CVE IDs to vulnerabilities within their scope
    						</div>
    					</div><!-- .su-role-text -->
    				</router-link>
    			</div>
    			<div class="su-message">
    				Select the role that best describes you
    			</div>
    		</div>
    		<div class="su-step su-step-2">
    			<div class="su-form su-discoverer-form" v-if="isDiscoverer()">
    				<h1>Sign Up as a Discoverer</h1>
    				<div class="su-form-description">Discoverers are individuals who find software vulnerabilities and provide vulnerability information by identifying new vulnerabilities and updating existing vulnerabilities in the CVE system</div>
						<div class="field">
						  <label class="label">First Name</label>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter First Name">
						  </div>
						</div>
						<div class="field">
						  <label class="label">Last Name</label>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter Last Name">
						  </div>
						</div>
						<div class="field">
						  <label class="label">E-mail</label>
						  <div class="control">
						    <input class="input " type="text" placeholder="Enter E-mail">
						  </div>
						  <!-- <p class="help is-danger">This email is invalid</p> -->
						</div>

						<div class="field">
						  <div class="control">
						    <label class="checkbox">
						      <input type="checkbox">
						      I agree to the <a href="#">terms and conditions</a>
						    </label>
						  </div>
						</div>

						<div class="field is-grouped">
						  <div class="control">
						    <button class="button is-link">Submit</button>
						  </div>
						  <div class="control">
						    <router-link tag="button" to="/signup" class="button is-text">Cancel</router-link>
						  </div>
						</div>    				
    			</div>
    			<div class="su-form su-authority-form" v-if="isAuthority()">
    				<h1>Sign Up as an Authority</h1>
    				<div class="su-form-description">
    							Authorities are organizations that are authorized to officially confirm vulnerabilities and assign CVE IDs to vulnerabilities affecting products within their distinct, agreed upon scope
    						</div>

						<div class="field">
						  <label class="label">Organization Name</label>
						  <div class="field-description">
						  	The full name of the organization used in the authority list and when showing related vulnerabilities.
						  	<br>E.g., “Microsoft Corporation”
							</div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter Organziation Name">
						  </div>
						</div>

						<div class="field">
						  <label class="label">Organization Short Name</label>
						  <div class="field-description">
						  	Should be 8 characters or less, if possible. This will be used for communications that require brevity such as Twitter alerts. E.g., “Microsoft”
						  </div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter Organziation Short Name">
						  </div>
						</div>
						<div class="field">
						  <label class="label">Country of Origin</label>
						  <div class="field-description">
						  	The corresponding country for the authority organization.
						  </div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter Organziation Country of Origin ">
						  </div>
						</div>

						<div class="field">
						  <label class="label">Disclosure Policy Location</label>
						  <div class="field-description">
									The location (URL) of the authority's disclosure policy. See <a href="https://cve.mitre.org/cve/cna/rules.html#Appendix_H">CNA Rules Appendix H</a> for more details<br />
									Below are a few examples of disclosure policies: 
									<ul>
										<li><a href="https://www.cert.org/vulnerability-analysis/vul-disclosure.cfm?">SEI vulnerability disclosure policy</a></li>
										<li><a href="https://www.enisa.europa.eu/publications/vulnerability-disclosure/at_download/fullReport">ENISA Good Practice Guide on Vulnerability Disclosure</a></li>
										<li><a href="https://www.iso.org/standard/72311.html">ISO/IEC 29147 Vulnerability Disclosure</a></li>
										<li><a href="https://www.ntia.doc.gov/files/ntia/publications/ntia_vuln_disclosure_early_stage_template.pdf">NTIA “Early Stage” Coordinated Vulnerability Disclosure Template</a></li>
										<li><a href="https://github.com/bugcrowd/disclosure-policy">Open Source Responsible Disclosure Framework</a></li>
										<li><a href="https://www.hackerone.com/disclosure-guidelines">Bug Bounty - HackerOne Disclosure Policy</a></li>
										<li><a href="https://www.rapid7.com/security/disclosure/">Researcher - Rapid7 Disclosure Policy</a></li>
									</ul>
						  </div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter Disclosure Policy Location">
						  </div>
						</div>

						<div class="field">
							<label class="label">Vulnerability Advisory Location</label>
							<div class="field-description">
								The locations (URLs) of the authority's vulnerability advisories. Multiple locations are supported, each authority must have at least one location. E.g.,
								<ul>
									<li><a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/securityadvisories">Microsoft Security Advisories</a></li>
									<li><a href="https://www.mcafee.com/enterprise/en-us/threat-center/product-security-bulletins.html">McAfee Product Securities Bulletins</a></li>
								</ul>
							</div>
							<div class="control">
								<div class="advisory-location" v-for="(a, index) in advisoryLocations">
									<div class="al-value">
										<input v-model="advisoryLocations[index]" class="input" type="text" placeholder="Enter Vulnerability Advisory Location">
									</div>
									<div class="al-remove">
										<div class="al-remove-button" v-on:click="confirmRemoveAdvisoryLocation(index)">
											<svg width="12" height="12">
												<g>
													<line class="primary-stroke" x1="11" y1="1" x2="1" y2="11"/>
													<line class="primary-stroke" x1="11" y1="11" x2="1" y2="1"/>
												</g>
											</svg>
											Remove
										</div>						  
									</div>						  
								</div>									
							  <a v-on:click="addAdvisoryLocation()">+ Add Advisory Location</a>
							</div>
						</div>

						<div class="field">
						  <label class="label">Public Point of Contact E-mail</label>
						  <div class="field-description">
						  	Primary means of contacting your organization for the CVE program, press and vulnerability discoverers.
						  </div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter E-mail">
						  </div>
						  <!-- <p class="help is-danger">This email is invalid</p> -->
						</div>

						<div class="field">
							<label class="label">Scope</label>
							<div class="field-description">
								Describe the software environment for which your organization will confirm vulnerabilities. For more information see the <a href="http://cveproject.github.io/docs/cna/Becoming%20a%20CNA.pptx" targe="_blank">Becoming a CNA guidance</a> or view some <a href="http://cve.mitre.org/cve/request_id.html#cna_participants " target="_blank">examples</a>.
							</div>
							<div class="control">
								<textarea class="textarea"></textarea>
							</div>
						</div>

						<div class="field">
							<label class="label">Root Authority</label>
							<div class="field-description">
								Select the Root CNA that is most appropriate for your organization's scope
							</div>
							<div class="control select">
								<select>
									<option>MITRE Corporation (Program Root)</option>
									<option>JPCERT/CC</option>
								</select>
							</div>
						</div>

						<div class="field">
						  <label class="label">Estimated Number of Annual Vulnerabilities</label>
						  <div class="control">
						    <label class="radio" style="display: block; margin: 0;">
						      <input checked="checked" type="radio" name="authtype">
						      1-49
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      50-99
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      100-199
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      200-299
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      300-499
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      500+
						    </label>
						  </div>
						</div>	

						<div class="field-group">
							<div class="field-group-label">Primary Point Of Contact (POC)</div>
							<div class="field-description">
								Primary Point Of Contact is contacted for internal use by the CVE program and will not made public.
							</div>
							<div class="field">
							  <label class="label">Full Name</label>						  
							  <div class="control">
							    <input class="input" type="text" placeholder="Enter Primary POC Full Name">
							  </div>
							</div>					
							<div class="field">
							  <label class="label">E-mail</label>						  
							  <div class="control">
							    <input class="input" type="text" placeholder="Enter Primary POC E-mail">
							  </div>
							</div>							
							<div class="field">
							  <label class="label">Phone Number</label>						  
							  <div class="control">
							    <input class="input" type="text" placeholder="Enter Primary POC Phone Number">
							  </div>
							</div>					
						</div><!-- .field-group -->

						<div class="field-group">
							<div class="field-group-label">Additional Points Of Contact (POC)</div>
							<div class="field-description">
								Additional Points Of Contact are contacted for internal use by the CVE program and their information will not made public.
							</div>
							<div class="secondary-pocs">
								<div class="secondary-poc" v-for="(poc, index) in secondaryPOCs">
									<div class="spoc-input">
										<div class="field">
										  <label class="label">Full Name</label>						  
										  <div class="control">
										    <input v-model="secondaryPOCs[index].name" class="input" type="text" placeholder="Enter Full Name">
										  </div>
										</div>					
										<div class="field">
										  <label class="label">E-mail</label>						  
										  <div class="control">
										    <input v-model="secondaryPOCs[index].email" class="input" type="text" placeholder="Enter E-mail">
										  </div>
										</div>							
										<div class="field">
										  <label class="label">Phone Number</label>						  
										  <div class="control">
										    <input v-model="secondaryPOCs[index].phone" class="input" type="text" placeholder="Enter Phone Number">
										  </div>
										</div>					
									</div>					
									<div class="spoc-remove">
										<div class="spoc-remove-button" v-on:click="confirmRemovePOC(index)">
											<svg width="12" height="12">
													<g>
														<line class="primary-stroke" x1="11" y1="1" x2="1" y2="11"/>
														<line class="primary-stroke" x1="11" y1="11" x2="1" y2="1"/>
													</g>
												</svg>
												Remove
										</div>
									</div>					
								</div>					
							</div>					
							<a v-on:click="addPOC()">+ Add Point of Contact</a>
						</div><!-- .field-group -->

						<div class="field">
						  <label class="label">E-mails for Authority E-mail List</label>
						  <div class="field-description">
						  	Comma separated list of emails for participation in the CVE Numbering Authority mailing list, which is primarily used for announcements and Aurthority-related discussion about issues.
						  </div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Enter E-mails for Authority List">
						  </div>
						</div>

<!-- 
Which Root is most appropriate for your scope?	Enter Root
A list of Root CNAs and their domains can be found at http://cve.mitre.org/cve/request_id.html#cna_coverage.html 

Estimated number of IDs needed in a year	Enter estimated # of ID’s needed per year

Primary POC Name	Enter primary POC name
Primary POC is for internal use by the CVE program, and will not be public for reporters
Primary POC email	Enter primary POC email address
Primary POC phone #	Enter primary POC phone number	


Secondary POC name(s)	Enter secondary POC name
Can be multiple POC’s
Secondary POC email(s)	Enter secondary POC email
Secondary POC phone #(s)	Enter secondary POC phone number(s)	




Emails for CNA mailing list participation	Enter email(s) for CNA mailing list participation
The CNA mailing list is used for announcements and discussions about issues that affect CNAs

Reason(s) you want to become a CNA	Enter reason(s)

Has your organization reserved CVE IDs from MITRE or another CNA before?	Choose an item.

Preferred dates and times for guidance meeting	Enter preferred dates and times
Typically takes 3-4 hours; the trainers are in Eastern UTC−04:00 time zone



 -->
						<div class="field">
						  <label class="label">Authority Type</label>
						  <div class="control">
						    <label class="radio" style="display: block; margin: 0;">
						      <input checked="checked" type="radio" name="authtype">
						      Software Vendor
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      Open Source Project
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      Coordination Center
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      Bug Bounty Service Provider
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="authtype">
						      Research Group
						    </label>
						  </div>
						</div>			
						<div class="field">
						  <label class="label">Has your organization reserved CVE IDs from MITRE or another CNA before?</label>
						  <div class="control">
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="reservedWithAnotherCNA">
						      Yes
						    </label>
						    <label class="radio" style="display: block; margin: 0;">
						      <input type="radio" name="reservedWithAnotherCNA">
						      No
						    </label>
						  </div>
						</div>						

						<div class="field">
						  <label class="label">Preferred Times for Guidance Meeting</label>
						  <div class="field-description">Preferred dates and times for guidance meeting	Enter preferred dates and times. Typically takes 3-4 hours; the trainers are in Eastern UTC−04:00 time zone.</div>
						  <div class="control">
						    <input class="input" type="text" placeholder="Text input">
						  </div>
						  <!-- <p class="help is-danger">This email is invalid</p> -->
						</div>

						<div class="field">
							<label class="label">Reason for becoming a CVE Numbering Authority (CNA)</label>
							<div class="field-description">Describe the reason(s) your organization wants to participate in the CVE program as a CVE Numbering Authority.</div>
							<div class="control">
								<textarea class="textarea"></textarea>
							</div>
						</div>

						<div class="field">
						  <div class="control">
						    <label class="checkbox">
						      <input type="checkbox">
						      I agree to the <a href="#">Terms and Conditions</a>
						    </label>
						  </div>
						</div>

						<div class="field is-grouped">
						  <div class="control">
						    <button class="button is-link">Submit</button>
						  </div>
						  <div class="control">
						    <router-link tag="button" to="/signup" class="button is-text">Cancel</router-link>
						  </div>
						</div>    				
    			</div>
    		</div>
    	</div>
    </div><!-- .su-inner -->
    <FooterModule></FooterModule>
  </div>
</template>

<script>
  import PriorityMessages from '@/components/PriorityMessages.vue';
  import PrimaryNav from '@/components/PrimaryNav.vue';
	import VulnerabilityNav from '@/components/VulnerabilityNav.vue';
	import FooterModule from '@/components/FooterModule.vue';
		export default {
		  name: 'SignUp',
		  components: {
		  	PriorityMessages: PriorityMessages,
		  	PrimaryNav: PrimaryNav,
		  	VulnerabilityNav: VulnerabilityNav,
	    	FooterModule: FooterModule
		  },
		  data: function() {
		  	return {
		  		secondaryPOCs: [
		  			{
		  				name: '',
		  				email: '',
		  				phone: ''
		  			}
		  		],
		  		advisoryLocations: [''],
		  		role: null
		  	}
		  },
		  mounted: function() {
		  	window.su = this;
		  	console.log('su mounted!!!');
		  	this.checkRole();
		  },
		  watch: {
		  	$route: function(to, from) {
		  		console.log('su route change');
		  		this.checkRole();
		  	}
		  },
		  methods: {
		  	addPOC: function() {
		  		this.secondaryPOCs.push({
		  			name: '',
		  			email: '',
		  			phone: ''
		  		});
		  	},
		  	confirmRemovePOC: function(index) {
		  		var s;
		  		if(this.secondaryPOCs[index].name.trim() === '') {
		  			s = 'Really remove this Point Of Contact?'
		  		} else {
		  			s = 'Really remove this Point Of Contact "' + this.secondaryPOCs[index].name.trim() + '"?'
		  		}
		  		var cfm = confirm(s);
		  		if(cfm) {
		  			this.removePOC(index);
		  		}
		  	},
		  	removePOC: function(index) {
		  		this.secondaryPOCs.splice(index, 1);
		  	},
		  	addAdvisoryLocation: function() {
		  		this.advisoryLocations.push('');
		  	},
		  	confirmRemoveAdvisoryLocation: function(index) {
		  		var cfm = confirm('Really remove this advisory location?');
		  		if(cfm) {
		  			this.removeAdvisoryLocation(index);
		  		}
		  	},
		  	removeAdvisoryLocation: function(index) {
		  		this.advisoryLocations.splice(index, 1);
		  	},
		  	selectRole: function(roleType) {
		  		this.$router.push({ path: 'sign-up', query: { role: roleType }});

		  	},
		  	checkRole: function() {
		  		console.log('su.checkRole');
		  		if(this.$route.query.role === 'discoverer') {
		  			this.role = 'discoverer';
		  		} else if (this.$route.query.role === 'authority') {
		  			this.role = 'authority';
		  		} else {
		  			this.role = null;
		  		}
		  		console.log('role = ' + this.role);
		  	},
		  	isOnFirstStep: function() {
		  		return this.role === null;
		  	},
		  	isDiscoverer: function() {
		  		return this.role === 'discoverer';
		  	},
		  	isAuthority: function() {
		  		return this.role === 'authority';
		  	}
		  }
		}
</script>

<style scoped lang="scss">
  @import '../assets/style/globals';

  .su-inner {
    margin: auto;
    max-width: $max-width;
    padding: 0;
  }

  .svg-fg {
  	fill: none;
		stroke: $fg1;
		stroke-width: 3;
		stroke-miterlimit: 10;
  }

  .su-roles {
  	margin: 20px 0 0 0;
  	display: flex;
  	align-content: flex-top;
  	justify-content: center;

  	.su-role-discoverer { margin-right: 20px;}
  	.su-role-authority { margin-left: 20px;}

  	.su-role:hover {
  		background: #eee;
  	}

  	.su-role {
  		width: 50%;
  		cursor: pointer;
  		text-align: center;
	    border: #ccc 1px solid;
	    padding: 20px;
	    border-radius: 18px;

  		.su-role-icon {
  			text-align: center;
  		}

  		.su-role-text {

  			.su-role-title {
  				font-weight: 700;
  				color: $fg1;
  			}

  			.su-role-description {
  				font-size: 14px;
  			}
  		}
  	}
  }

  .su-message {
  	color: $fg1;
  	margin: 50px 0;
  	text-align: center;
  }

  h1 {
    font-size: 20px;
    margin-bottom: 15px;
  }

  .su-form {
  	padding: 0 20px;
  	margin-bottom: 50px;
  }

  .su-form-description {
  	margin-bottom: 20px;
  }

  // TODO: add to globals?
  .field {
    border-bottom: #ddd 1px solid;
    padding-bottom: 20px;
  }

  .field-description {  	
    font-size: 14px;
    margin-bottom: 10px;
  }

  .advisory-location {
  	display: flex;
  	align-items: center;
    margin-bottom: 10px;
  }

  .al-value {
  	flex-grow: 2;
  	margin-right: 10px;
  }

  .al-remove-button,
  .spoc-remove-button {
  	cursor: pointer;
  }

  .al-remove-button:hover,
  .spoc-remove-button:hover {
  	opacity: 0.5;
  }

  ul {
  	margin-top: 4px;
    padding-left: 30px;
    list-style: disc;
  }

  .field-group {
  	padding-bottom: 20px;
    border-bottom: #ddd 1px solid;
  	margin-bottom: 10px;
  	.field {
  		border-bottom: none;
  		padding-bottom: 0;

  		label {
  			font-size: 12px;
  		}
  	}
  }

  .field-group-label {
  	font-size: 16px;
  	font-weight: 600;
  	margin-bottom: 10px;
  }

  .secondary-poc {
  	display: flex;
    padding-bottom: 25px;
    margin-bottom: 15px;
    border-bottom: #eee 1px solid;
  }

  .secondary-poc:last-child {
  	border-bottom: none;
  	margin-bottom: 0;
    padding-bottom: 10px;
  }

  .spoc-input {
  	flex-grow: 2;
  }

  .spoc-remove {  	
    margin-top: 30px;
    margin-left: 14px;
  }

</style>