<template>
  <div id="cve-json-container">
    <h1 class="title">{{cveId}}</h1>
    <JsonTree :raw="JSON.stringify(record, null, 2)"></JsonTree>
  </div>
</template>

<script>
import _ from 'lodash';
import JsonTree from 'vue-json-tree';

export default ({
  name: 'CVEJsonView',
  components: {
    JsonTree,
  },
  data() {
    return {
      record: {},
      cveId: localStorage.getItem('cveId'),
    };
  },
  created() {
    console.log('CVEJSONView created');
    this.getJSon();
  },
  methods: {
    getJSon() {
      const isArecord = localStorage.getItem('isArecord');
      const recordData = JSON.parse(localStorage.getItem('recordData'));
      const idData = JSON.parse(localStorage.getItem('idData'));
      console.log('1, ', _.isEmpty(recordData), _.isEmpty(idData));
      console.log('2, ', _.isUndefined(isArecord), !_.isUndefined(isArecord));
      console.log('3, ', _.isEmpty(recordData), !_.isEmpty(recordData));
      console.log('4, ', _.isEmpty(idData), !_.isEmpty(idData));
      console.log('recordData ', recordData);
      console.log('idData', idData);

      if (isArecord === 'undefined' || (_.isEmpty(recordData) && _.isEmpty(idData))) {
        this.$router.push('/');
      }
      if (isArecord === 'true' && !_.isEmpty(recordData)) {
        this.record = recordData;
      } else if (isArecord === 'false' && !_.isEmpty(idData)) {
        this.record = idData;
      } else {
        this.$router.push('/');
      }
    },
  },
});
</script>

<style lang="scss">
@import '@/assets/style/globals.scss';

.json-tree {
  font-size: 16px !important;
}

.json-tree-value {
  color: $theme-color-primary-darker !important;
  /* unset to show overflown text */
  overflow: unset !important;
  white-space: unset !important;
}
</style>
