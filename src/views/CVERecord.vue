<template>
  <div id="cve-secondary-page-main-container">
    <div class="columns is-centered">
      <div class="column is-12-desktop is-11-tablet cve-main-column-content-width">
        <main id="cve-main-page-content" role="main">
          <h1 class="title">CVE Record Lookup</h1>
          <div v-if="error" class="notification is-warning">
            <div class="is-flex" style="justify-content: center;">
              <p id="alertIcon" class="is-hidden">alert</p>
              <font-awesome-icon style="flex: 0 0 40px;" size="1x"  icon="exclamation-triangle" role="alert"
                aria-labelledby="alertIcon" aria-hidden="false" />
              <p>{{this.$store.state.cveId}} not found</p>
            </div>
          </div>
          <div v-else>
            <h2 class="title">{{ this.$store.state.cveId}}</h2>
          </div>
        </main>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'CVERecord',
  data() {
    return {
      records: {
        'CVE-2020-19045': {
          data_type: 'CVE',
          data_format: 'MITRE',
          data_version: '4.0',
          CVE_data_meta: {
            ID: 'CVE-2020-19045',
            ASSIGNER: 'cve@mitre.org',
            STATE: 'RESERVED',
          },
          description: {
            description_data: [
              {
                lang: 'eng',
                value: '** RESERVED ** This candidate has been reserved by an organization or individual that will use it when announcing a new'
                + 'security problem. When the candidate has been publicized, the details for this candidate will be provided.',
              },
            ],
          },
        },
        'CVE-2020-13644': {
          CVE_data_meta: {
            ASSIGNER: 'cve@mitre.org',
            ID: 'CVE-2020-13644',
            STATE: 'PUBLIC',
          },
          affects: {
            vendor: {
              vendor_data: [
                {
                  product: {
                    product_data: [
                      {
                        product_name: 'n/a',
                        version: {
                          version_data: [
                            {
                              version_value: 'n/a',
                            },
                          ],
                        },
                      },
                    ],
                  },
                  vendor_name: 'n/a',
                },
              ],
            },
          },
          data_format: 'MITRE',
          data_type: 'CVE',
          data_version: '4.0',
          description: {
            description_data: [
              {
                lang: 'eng',
                value: 'An issue was discovered in the Accordion plugin before 2.2.9 for WordPress. The unprotected AJAX'
                + ', wp_ajax_accordions_ajax_import_json action allowed any authenticated user with Subscriber or higher permissions the ability to'
                + 'import a new accordion and inject malicious JavaScript as part of the accordion.',
              },
            ],
          },
          problemtype: {
            problemtype_data: [
              {
                description: [
                  {
                    lang: 'eng',
                    value: 'n/a',
                  },
                ],
              },
            ],
          },
          references: {
            reference_data: [
              {
                url: 'https://www.wordfence.com/blog/2020/04/vulnerability-patched-in-accordion-plugin/',
                refsource: 'MISC',
                name: 'https://www.wordfence.com/blog/2020/04/vulnerability-patched-in-accordion-plugin/',
              },
              {
                url: 'https://wordpress.org/plugins/accordions/#developers',
                refsource: 'MISC',
                name: 'https://wordpress.org/plugins/accordions/#developers',
              },
            ],
          },
          impact: {
            cvss: {
              attackComplexity: 'LOW',
              attackVector: 'NETWORK',
              availabilityImpact: 'NONE',
              confidentialityImpact: 'LOW',
              integrityImpact: 'LOW',
              privilegesRequired: 'LOW',
              scope: 'CHANGED',
              userInteraction: 'REQUIRED',
              vectorString: 'CVSS:3.0/AC:L/AV:N/A:N/C:L/I:L/PR:L/S:C/UI:R',
              version: '3.0',
            },
          },
        },
        'CVE-2019-9978': {
          CVE_data_meta: {
            ASSIGNER: 'cve@mitre.org',
            ID: 'CVE-2019-9978',
            STATE: 'PUBLIC',
          },
          affects: {
            vendor: {
              vendor_data: [
                {
                  product: {
                    product_data: [
                      {
                        product_name: 'n/a',
                        version: {
                          version_data: [
                            {
                              version_value: 'n/a',
                            },
                          ],
                        },
                      },
                    ],
                  },
                  vendor_name: 'n/a',
                },
              ],
            },
          },
          data_format: 'MITRE',
          data_type: 'CVE',
          data_version: '4.0',
          description: {
            description_data: [
              {
                lang: 'eng',
                value: 'The social-warfare plugin before 3.5.3 for WordPress has stored XSS via the wp-admin/admin-post.php?swp_debug=load_options'
                + 'swp_url parameter, as exploited in the wild in March 2019. This affects Social Warfare and Social Warfare Pro.',
              },
            ],
          },
          problemtype: {
            problemtype_data: [
              {
                description: [
                  {
                    lang: 'eng',
                    value: 'n/a',
                  },
                ],
              },
            ],
          },
          references: {
            reference_data: [
              {
                refsource: 'MISC',
                name: 'https://wpvulndb.com/vulnerabilities/9238',
                url: 'https://wpvulndb.com/vulnerabilities/9238',
              },
              {
                url: 'https://www.cybersecurity-help.cz/vdb/SB2019032105',
                refsource: 'MISC',
                name: 'https://www.cybersecurity-help.cz/vdb/SB2019032105',
              },
              {
                url: 'https://blog.sucuri.net/2019/03/zero-day-stored-xss-in-social-warfare.html',
                refsource: 'MISC',
                name: 'https://blog.sucuri.net/2019/03/zero-day-stored-xss-in-social-warfare.html',
              },
              {
                url: 'https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/',
                refsource: 'MISC',
                name: 'https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/',
              },
              {
                url: 'https://www.pluginvulnerabilities.com/2019/03/21/full-disclosure-of-settings-change-persistent-cross-site-scripting-xss-'
                + 'vulnerability-in-social-warfare/',
                refsource: 'MISC',
                name: 'https://www.pluginvulnerabilities.com/2019/03/21/full-disclosure-of-settings-change-persistent-cross-site-scripting-xss-'
                + 'vulnerability-in-social-warfare/',
              },
              {
                url: 'https://wordpress.org/plugins/social-warfare/#developers',
                refsource: 'MISC',
                name: 'https://wordpress.org/plugins/social-warfare/#developers',
              },
              {
                url: 'https://twitter.com/warfareplugins/status/1108852747099652099',
                refsource: 'MISC',
                name: 'https://twitter.com/warfareplugins/status/1108852747099652099',
              },
              {
                refsource: 'EXPLOIT-DB',
                name: '46794',
                url: 'https://www.exploit-db.com/exploits/46794/',
              },
              {
                refsource: 'MISC',
                name: 'http://packetstormsecurity.com/files/152722/Wordpress-Social-Warfare-Remote-Code-Execution.html',
                url: 'http://packetstormsecurity.com/files/152722/Wordpress-Social-Warfare-Remote-Code-Execution.html',
              },
            ],
          },
        },
      },
      recordData: {},
      iaLoading: true,
      error: false,
    };
  },
  beforeMount() {
    this.lookupId();
  },
  updated() {
    this.lookupId();
  },
  methods: {
    lookupId() {
      this.resetStates();
      if (Object.prototype.hasOwnProperty.call(this.records, this.$store.state.cveId)) {
        this.recordData = this.records[this.$store.state.cveId];
      } else {
        this.error = true;
      }
    },
    resetStates() {
      this.error = false;
      this.isLoading = true;
      this.recordData = {};
    },
  },
};

</script>

<style scoped lang="scss">
@import '@/assets/style/globals.scss';
</style>
