import Vue from 'vue';
import Vuex from 'vuex';
import axios from 'axios';

Vue.use(Vuex);

export default new Vuex.Store({
  state: {
    metricsRootURL: 'https://cvecps-dev.mitre.org',
  	authenticated: false,
  	user: {
  		email: null,
      role: null
  	},
    publishedEntryCount: undefined,
    publishedEntryCountByWeakness: undefined,
    publishedEntryCountByAuthority: undefined,
    

  },
  getters: {
  	getAuthenticated: function(state) {
  		return state.authenticated;
  	},
  	getEmail: function(state) {
  		return state.user.email;
  	},
    getRole: function(state) {
      return state.user.role;
    }
  },
  mutations: {
  	setAuthenticated: function(state, auth) {
  		state.authenticated = auth;
  	},
  	setEmail: function(state, email) {
  		state.user.email = email;
  	},
    setRole: function(state, role) {
      state.user.role = role;
    }
  },
  actions: {
    loadMetrics: function(context) {
      console.log('Loading metrics...');
      context.dispatch('loadPublishedEntries');
    },
    loadPublishedEntries: function(context) {
      console.log('Loading published CVE entries...');
      // axios.get(context.state.metricsRootURL + '/cps/ws/metrics/cve_entries/by_date_range/')
      axios.get('https://cvecps-dev.mitre.org/cps/ws/metrics/cve_entries/by_date_range_grouped/?start=1980-01-02&end=2020-06-30&group_by=weakness')
        .then(function (response) {
          
        })
        .catch(function (error) {
          console.log(error);
        });          
    }
  },
});
