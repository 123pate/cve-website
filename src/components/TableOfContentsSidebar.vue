<template>
  <aside class="menu">
    <p class="menu-label cve-capitalize-first-letter">Table of Contents</p>
    <ul class="menu-list cve-capitalize-first-letter">
      <li v-for="(sectionObj, index) in nav.pageSections" :key="index">
        <router-link :to="'#' + sectionObj.sectionId">{{ sectionObj.sectionTitle }}</router-link>
        <ul>
          <li v-for="(subSectionObj, index) in sectionObj.subSections" :key="index">
          <router-link :to="'#' + subSectionObj.subSectionId" >{{ subSectionObj.subSectionTitle }}</router-link>
          <b-collapse animation="slide" :open="isOpen == index" @open="isOpen = index">
          <template #trigger="props">
            <div class="cve-toc-subSection-header" role="button">
            <a v-if="subSectionObj.subSubSections.length>0" class="cve-toc-icon">
               <b-icon
                pack="fas"
                :icon="props.open ? 'caret-down' : 'caret-up'">
               </b-icon>
            </a>
            </div>
            </template>

            <ul>
             <li v-for="(subSubSectionObj, index) in subSectionObj.subSubSections" :key="index">
             <router-link :to="'#' + subSubSectionObj.subSubSectionId">{{ subSubSectionObj.subSubSectionTitle }}</router-link>
            </li>
           </ul> <!-- end subSubSection list -->
        </b-collapse>
      </li>
     </ul> <!-- end subSection list -->
    </li>
   </ul> <!-- end section list -->
  </aside>
</template>

<script>
export default {
  props: {
    nav: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      isActive: true,
      isOpen: -1,
    };
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
@import '../assets/style/globals.scss';

a.router-link-exact-active {
  background: $theme-color-accent-cool-light;
}

.menu-list .cve-toc-subSection-header, .cve-toc-icon {
  display: inline;
}

.menu-label, .menu-list {
    text-align:  left;
}

.menu-label {
    margin-bottom: 8px;
}

.menu {
    background: white;
    border: 1px solid gray;
    padding: 16px;
    margin-top: unset;
    border-radius: 2px;
}

</style>
