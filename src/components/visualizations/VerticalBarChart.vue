<template>
  <div class="vertical-bar-chart">
    <div class="chart-title">
      <div class="chart-title-inner">
        {{title}}
      </div>
    </div>
    <svg ref="svg"></svg>
  </div><!-- .vertical-bar-chart -->
</template>

<script>
import * as d3 from 'd3';
export default {
  name: 'HorizontalBarChart',
  props:[ 
    'title',
    'xLabel',
    'yLabel',
    'width',
    'height',
    'visualizationData'
  ],
  data: function() {
  	return {
  	
  	}
  },
  methods: {
    
  },
  mounted: function() {
    // 
// <svg width="960" height="500"></svg>
var chartWidth = this.width,
    chartHeight = this.height;

var svg = d3.select(this.$refs.svg)
  .attr('width', chartWidth)
  .attr('height', chartHeight),
    margin = {top: 20, right: 20, bottom: 50, left: 75},
    width = chartWidth - margin.left - margin.right,
    height = chartHeight - margin.top - margin.bottom;

var x = d3.scaleBand().rangeRound([0, width]).padding(0.5),
    y = d3.scaleLinear().rangeRound([height, 0]);

var g = svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
var data = [
  {
  year: 1999,
  count: 894
  },
  {
    year: 2000,
    count: 1020
  },
  {
    year: 2001,
    count: 1677
  },
  {
    year: 2002,
    count: 2156
  },
  {
    year: 2003,
    count: 1527
  },
  {
    year: 2004,
    count: 2451
  },
  {
    year: 2005,
    count: 4935
  },
  {
    year: 2006,
    count: 6610
  },
  {
    year: 2007,
    count: 6520
  },
  {
    year: 2008,
    count: 5632
  },
  {
    year: 2009,
    count: 5736
  },
  {
    year: 2010,
    count: 4652
  },
  {
    year: 2011,
    count: 4155
  },
  {
    year: 2012,
    count: 5297
  },
  {
    year: 2013,
    count: 5191
  },
  {
    year: 2014,
    count: 7946
  },
  {
    year: 2015,
    count: 6484
  },
  {
    year: 2016,
    count: 6447
  },
  {
    year: 2017,
    count: 14714
  },
  {
    year: 2018,
    count: 16556
  },
  {
    year: 2019,
    count: 12174
  }
];

x.domain(data.map(function(d) { return d.year; }));
y.domain([0, 1000 + d3.max(data, function(d) { return d.count; })]);

g.append("g")
    .attr("class", "axis axis--x")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x).tickSize(8));

g.append("g")
    .attr("class", "axis axis--y")
    .call(d3.axisLeft(y).ticks(6));

g.selectAll('.axis--y .tick')
  .each(function(d,i) {
    d3.select(this)
      .append('line')
      .attr('class', 'grid-line')
      .attr('x1', 1)
      .attr('y1', 0)
      .attr('y2', 0)
      .attr('x2', width);
  });
// text label for the x axis
svg.append("text")             
  .attr("transform",
        "translate(" + (width/2 + margin.left) + " ," + 
                       (height + margin.top + margin.bottom) + ")")
  .style("text-anchor", "middle")
  .text("Year");

// text label for the y axis
svg.append("text")
  .attr("transform", "rotate(-90)")
  .attr("y", 0)
  .attr("x",0 - (height / 2))
  .attr("dy", "1em")
  .style("text-anchor", "middle")
  .text("Number of Vulnerabilities");      

g.append('rect')
  .attr('class','border')
  .attr('x', 1)
  .attr('y', 0)
  .attr('width', width)
  .attr('height', height);

g.selectAll(".bar")
  .data(data)
  .enter().append("rect")
    .attr("class", "bar")
    .attr("x", function(d) { return x(d.year); })
    .attr("y", function(d) { return y(d.count); })
    .attr("width", x.bandwidth())
    .attr("height", function(d) { return height - y(d.count) - 1; });

  }
};
</script>

<style lang="scss">
	svg text {
		font-family: 'Roboto';
		font-size: 13px;
		text-transform: uppercase;
	}

  .bar {
    fill: #000;
    /*stroke: #fff;
    shape-rendering: crispEdges;*/
  }

  .bar:hover {
    fill: brown;
  }

  .axis--x path,
  .axis--x line {
    display: none;
  }

  .grid-line {
    stroke: #e5e5e5;
  }

  .border {
    fill: none;
    stroke: #000;
    shape-rendering: crispEdges;
  }

  .chart-title-inner {
    max-width: 890px;
    margin: auto;
    text-align: left;
    text-transform: uppercase;
    color: #000;
    font-size: 14px;
    font-weight: 700;
  }

  .tick text {
    font-size: 11px;
  }
/*
	.bar-click {
		cursor: pointer;
		fill: transparent;
	}

	.bar-click:hover {
		fill: #eee;
	}

	.order-text,
	.label-text,
	.value-text,
	.bar-rect {
		pointer-events: none;
	}*/
</style>
