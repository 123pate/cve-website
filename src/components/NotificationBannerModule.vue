<template>
  <header id="CVE-Notification-Banner" class="is-info" role="alert" v-if="this.$store.state.shouldDisplay">
    <div class="notification is-info" style="padding: 10px;">

      <div class="" style="justify-content:left; margin:auto;">
        <div>        
          <section class="accordions">
            <div style="display:flex">
            <article  class="accordion is-active" style="display:flex;">
              <div class="notification-short" style="width:35%; float:left;" :class="{'is-hidden': accordian['notificationshort']}" id="notificationshort">
                <div class="accordion-body">
                  <div class="accordion-content" style="text-overflow: ellipsis; overflow: hidden; white-space:nowrap;">
                      <p id="alertIcon" class="is-hidden">alert</p>
                      <font-awesome-icon style="flex: 0 0 40px; margin-top:3px" size="1x"  icon="info-circle" role="alert"
                        aria-labelledby="alertIcon" aria-hidden="false"/>
                      <span v-for="(section, index) in notificationContents" :key="index">
                        <span v-if="section.contentType == 'paragraph'" v-html="$sanitize(section.content) + ' '"></span>
                        <span class="has-text-weight-bold" v-if="section.contentType == 'bold'">{{section.content}} </span>
                        <a v-if="section.contentType == 'externalLink'" :href="section.link" target="_blank">{{section.linkText}}
                          <span class="icon cve-icon-xxs">
                            <p :id="'bannerExtenalLink' + index" class="is-hidden">external link</p>
                            <font-awesome-icon icon="external-link-alt" :aria-labelledby="'bannerExtenalLink' + index"/>
                          </span>
                          {{ ' ' }}
                        </a>
                        <span v-if="section.contentType == 'internalLink'">
                          <router-link :to="section.link">{{section.linkText}} </router-link>
                        </span>
                      </span>

                  </div>
                </div>
              </div>
            </article>

            <article style=" width:90%; float:left;" class="accordion is-active">
              <div class="notification-body" :class="{'is-hidden': accordian['notification']}" id="notification">
                <div class="accordion-body">
                  <div class="accordion-content">
                    <p id="alertIcon" class="is-hidden">alert</p>
                    <font-awesome-icon style="flex: 0 0 40px; margin-top:3px" size="1x"  icon="info-circle" role="alert"
                      aria-labelledby="alertIcon" aria-hidden="false"/>
                    <span v-for="(section, index) in notificationContents" :key="index">
                      <span v-if="section.contentType == 'paragraph'" v-html="$sanitize(section.content) + ' '"></span>
                      <span class="has-text-weight-bold" v-if="section.contentType == 'bold'">{{section.content}} </span>
                      <a v-if="section.contentType == 'externalLink'" :href="section.link" target="_blank">{{section.linkText}}
                        <span class="icon cve-icon-xxs">
                          <p :id="'bannerExtenalLink' + index" class="is-hidden">external link</p>
                          <font-awesome-icon icon="external-link-alt" :aria-labelledby="'bannerExtenalLink' + index"/>
                        </span>
                        {{ ' ' }}
                      </a>
                      <span v-if="section.contentType == 'internalLink'">
                        <router-link :to="section.link">{{section.linkText}} </router-link>
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </article>

              <div style="fixed:right;">
                <button id="alertIcon" class="button" @click="toggleAccordianItem('notification', 'notificationshort')"
                  :aria-expanded="!accordian['notification', 'notificationshort'] ? 'true' : 'false'"
                  
                  aria-controls="notification; notificationshort">
                  <span class="icon is-small">

                  <font-awesome-icon :icon="accordian['notification', 'notificationshort'] ? 'minus' : 'plus'"
                    aria-hidden="false" focusable="true" aria-labelledby="notification-alttext"/>
                  </span>
                </button>
              </div>
          </div>
          </section>




        </div>
      </div>
    </div>
  </header>
</template>

<script>
import Vue from 'vue';
import NotificationData from '@/assets/data/NotificationBanner.json';

export default {
  data() {
    return {
      notificationContents: NotificationData.notificationContents,
      accordian: { notification: true, notificationshort: false },
    };
  },
  methods: {
    hideNotificationBanner() {
      return this.$store.commit('hideNotificationBanner');
    },
    showNotificationBanner() {
      return this.$store.commit('showNotificationBanner');
    },
    toggleAccordianItem(id1, id2) {
      Vue.set(this.accordian, id1, !this.accordian[id1]);
      Vue.set(this.accordian, id2, !this.accordian[id2]);
    },
  },
  beforeMount() {
    this.showNotificationBanner();
  },
};

</script>

<style scoped lang="scss">
@import '../assets/style/globals.scss';

</style>
