<template>
  <aside class="menu is-hidden-touch cve-sidebar-menu">
    <p class="menu-label cve-capitalize-first-letter">{{nav.label}}</p>
    <ul class="menu-list cve-capitalize-first-letter">
      <li v-for="(submenuObj, submenuLabel) in nav.submenu" :key="submenuLabel.id">
        <span class="is-flex" style="justify-content: space-between; width: inherit">
          <router-link :to="submenuObj.path">{{ submenuLabel }}</router-link>
              <!-- <a :href="menuObj.primaryNavPath" class="navbar-link is-arrowless">{{menuItemLabel}}</a> -->
              <a class="button is-text cve-button-submenu-toggle" @click="toggleSubmenuItem(`/${nav.path}/${submenuObj.path}`)">
                <span class="icon is-small">
                  <font-awesome-icon class="icon cve-icon-xxs" :icon="selectedSubmenu.includes(`/${nav.path}/${submenuObj.path}`) ? 'minus' : 'plus'"/>
                </span>
              </a>
        </span>
        
        <ul v-show="selectedSubmenu.includes(`/${nav.path}/${submenuObj.path}`)">
          <li v-for="(anchorId, label) in submenuObj.items" :key="submenuObj.id + label">
            <router-link :to="submenuObj.path + '#' + anchorId">{{ label }}</router-link>
          </li>
        </ul>
    </li>
    </ul>
  </aside>
</template>

<script>
export default {
  props: {
    nav: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      isActive: true,
      selectedSubmenu: [this.$router.currentRoute.path],
    };
  },
  created: function() {
    console.log(this.selectedSubmenu)
  },
  methods: {
    toggleSubmenuItem: function(path) {
      if (this.selectedSubmenu.includes(path)) {
        this.selectedSubmenuselectedMenu = this.selectedSubmenu.filter(
          (item) => item !== path,
        );
      } else {
        this.selectedSubmenu.push(path);
      }
      console.log(this.$router.currentRoute);
    },
  }
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
@import '../assets/style/globals.scss';

a.router-link-exact-active{
  background: $theme-color-accent-cool-light;
}

.cve-sidebar-menu {
  position: sticky;
}
.menu-label, .menu-list {
    text-align:  left;
}

.menu-label {
    margin-bottom: 8px;
}

.menu {
    background: white;
    border: 1px solid gray;
    padding: 16px;
    margin-top: unset;
    border-radius: $cve-border-radius;
}

</style>
